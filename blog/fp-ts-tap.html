<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4cf2300e9c8272f7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/b20daecae68a588f-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/de70bee13400563f.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5b223268c7b94054.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5decdc74ef1a7f94.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/c21425aba4482c2f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-5788873a3947c2cc.js"/><script src="/_next/static/chunks/4bd1b696-18452535c1c4862d.js" async=""></script><script src="/_next/static/chunks/684-a40553b8f97e5ad6.js" async=""></script><script src="/_next/static/chunks/main-app-08d8e87f5b019b96.js" async=""></script><script src="/_next/static/chunks/874-36030fac62063c21.js" async=""></script><script src="/_next/static/chunks/63-5ad18c88ec2f5164.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-ca6c25fdf74e0262.js" async=""></script><meta name="next-size-adjust" content=""/><title>fp-ts 进阶指南：深度解析 tap 系列副作用函数 | 格物致知</title><meta name="description" content="深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。"/><meta name="keywords" content="TypeScript,fp-ts,函数式编程"/><meta property="og:title" content="fp-ts 进阶指南：深度解析 tap 系列副作用函数"/><meta property="og:description" content="深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2026-01-28"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="fp-ts 进阶指南：深度解析 tap 系列副作用函数"/><meta name="twitter:description" content="深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_8def3f __variable_188709 __variable_9a8899 antialiased"><div class="min-h-screen bg-background text-foreground"><div class="max-w-2xl mx-auto px-4 py-12"><article><header class="mb-12"><div class="flex flex-wrap gap-2 mb-6"><span class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg">TypeScript</span><span class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg">fp-ts</span><span class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg">函数式编程</span></div><h1 class="text-2xl md:text-4xl text-gray-900 dark:text-gray-100 mb-6 leading-tight">fp-ts 进阶指南：深度解析 tap 系列副作用函数</h1><p class="font-light text-md text-gray-600 dark:text-gray-400 leading-relaxed mb-6 italic">深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。</p><div class="flex items-center text-sm text-gray-500 dark:text-gray-500"><time dateTime="2026-01-28">2026年1月28日</time></div><div class="w-16 h-px bg-gray-300 dark:bg-gray-600 mt-8"></div></header><article class="max-w-none prose prose-pink prose-img:rounded-lg prose-video:rounded-lg dark:prose-invert prose-a:text-foreground prose-a:decoration-6 prose-a:-underline-offset-2 prose-a:decoration-pink-300"><blockquote>
<p>本文旨在解析 fp-ts 库中 <code>tap</code> 系列函数的核心逻辑。通过对比 <code>tap</code>、<code>tapIO</code>、<code>tapTask</code> 等不同变体，阐述如何在保持数据流向不变的前提下，优雅地处理同步或异步的副作用，并重点分析了 <code>tapError</code> 在错误处理路径中的控制权。</p>
</blockquote>
<h3>tap 系列函数的核心逻辑都是：“偷看一眼，做点副业，原样返回”。</h3>
<p>tap 全家桶对比表, 假设我们当前的操作流是一个 TaskEither&lt;E, A&gt;：</p>
<table><thead><tr><th style="text-align:left">函数名称</th><th style="text-align:left">针对对象</th><th style="text-align:left">传入函数返回类型</th><th style="text-align:left">核心用途</th></tr></thead><tbody><tr><td style="text-align:left">tap</td><td style="text-align:left">Right (成功值)</td><td style="text-align:left">(a: A) =&gt; TaskEither&lt;E, A&gt;</td><td style="text-align:left">最通用。执行异步操作（如存入数据库），若副作用失败，流程也转为失败。</td></tr><tr><td style="text-align:left">tapIO</td><td style="text-align:left">Right (成功值)</td><td style="text-align:left">(a: A) =&gt; IO&lt;A&gt;</td><td style="text-align:left">执行同步副作用（如 console.log、修改全局变量）。</td></tr><tr><td style="text-align:left">tapTask</td><td style="text-align:left">Right (成功值)</td><td style="text-align:left">(a: A) =&gt; Task&lt;A&gt;</td><td style="text-align:left">执行必定成功的异步副作用（如发送不关结果的统计埋点）。</td></tr><tr><td style="text-align:left">tapEither</td><td style="text-align:left">Right (成功值)</td><td style="text-align:left">(a: A) =&gt; Either&lt;E, A&gt;</td><td style="text-align:left">执行同步但可能失败的检查（如简单的参数校验）。</td></tr><tr><td style="text-align:left">tapError</td><td style="text-align:left">Left (错误值)</td><td style="text-align:left">(e: E) =&gt; TaskEither&lt;E, A&gt;</td><td style="text-align:left">针对错误执行副作用（如记录错误日志）。</td></tr></tbody></table>
<h3>谁会中断流程</h3>
<table><thead><tr><th style="text-align:left">函数</th><th style="text-align:left">类型</th><th style="text-align:left">异步？</th><th style="text-align:left">会中断主流程吗？</th><th style="text-align:left">适用场景</th></tr></thead><tbody><tr><td style="text-align:left">tapIO</td><td style="text-align:left">IO&lt;A&gt;</td><td style="text-align:left">否</td><td style="text-align:left">不会</td><td style="text-align:left">写日志、读本地配置</td></tr><tr><td style="text-align:left">tapEither</td><td style="text-align:left">Either&lt;E, A&gt;</td><td style="text-align:left">否</td><td style="text-align:left">会 (若返回 Left)</td><td style="text-align:left">同步校验、业务规则检查</td></tr><tr><td style="text-align:left">tapTask</td><td style="text-align:left">Task&lt;A&gt;</td><td style="text-align:left">是</td><td style="text-align:left">不会</td><td style="text-align:left">后台统计、非关键性通知</td></tr><tr><td style="text-align:left">tap</td><td style="text-align:left">TaskEither&lt;E, A&gt;</td><td style="text-align:left">是</td><td style="text-align:left">会 (若返回 Left)</td><td style="text-align:left">存数据库、调用第三方支付 API</td></tr></tbody></table>
<p>Q: 为什么tapError要返回 TaskEither， 为什么不能像tapTask那样?</p>
<p>A: 这里有一个微妙的逻辑：tapError 虽然不能把“失败”变回“成功”，但它有权决定“失败的原因是否要升级或改变”</p>
<p>在函数式编程中，我们追求对错误路径的极端控制。请看这个场景</p>
<ul>
<li>场景：数据库连接失败（原始错误）。</li>
<li>副作用：我们希望 LoggerService 把这个错误存到远程日志服务器。</li>
<li>新问题：如果此时远程日志服务器也挂了，该怎么办？</li>
</ul>
<p>通过返回 TaskEither，tapError 允许：</p>
<ul>
<li>保持原样：如果日志记录成功，传出的依然是原始的“数据库连接失败”。</li>
<li>替换错误：如果日志记录也失败了，可以选择抛出一个更严重的错误（例如：数据库失败且日志系统宕机）。</li>
</ul>
<p>Q: 像tapEither和tap即tapTaskEither, 他们返回Either&lt;E,A&gt; 或者TaskEither&lt;E,A&gt;, 都可以中断业务流程 那我们为什么不直接通过flatMap 或者chainW 来把它chain到进主流程呢, 该如何理解呢?</p>
<p>A: 简单直接的答案是：语义化（Semantics） 和 代码组合性（Composability）</p>
<p>虽然 flatMap (在 fp-ts 中叫 chain) 确实可以实现 tap 的所有功能，但使用 tap 系列函数有以下三个不可替代的理由</p>
<ul>
<li>保护“主干数据”不被破坏, 这是最实际的理由。tap 的逻辑是：输入是什么，输出就必须是什么。</li>
</ul>
<p>使用 chain：如果你只是想在中间存个数据库，用 chain 的话，你必须手动在函数最后把原始数据返回，否则下一步就拿不到数据了。</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="ts" data-theme="github-dark-dimmed"><code data-language="ts" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#ADBAC7">typescript;</span></span>
<span data-line=""><span style="color:#DCBDFB">pipe</span><span style="color:#ADBAC7">(</span></span>
<span data-line=""><span style="color:#DCBDFB">  fetchUser</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">1</span><span style="color:#ADBAC7">),</span></span>
<span data-line=""><span style="color:#6CB6FF">  TE</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">chain</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">user</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span></span>
<span data-line=""><span style="color:#DCBDFB">    pipe</span><span style="color:#ADBAC7">(</span></span>
<span data-line=""><span style="color:#DCBDFB">      saveToCache</span><span style="color:#ADBAC7">(user), </span><span style="color:#768390">// 返回 TE.right(void)</span></span>
<span data-line=""><span style="color:#6CB6FF">      TE</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">map</span><span style="color:#ADBAC7">(() </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> user), </span><span style="color:#768390">// 你必须手动把 user 传下去，极其啰嗦</span></span>
<span data-line=""><span style="color:#ADBAC7">    ),</span></span>
<span data-line=""><span style="color:#ADBAC7">  ),</span></span>
<span data-line=""><span style="color:#ADBAC7">);</span></span></code></pre></figure>
<p>使用 tap：它自动帮你把输入传递给输出，只需要关注副作用本身</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="ts" data-theme="github-dark-dimmed"><code data-language="ts" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#DCBDFB">pipe</span><span style="color:#ADBAC7">(</span></span>
<span data-line=""><span style="color:#DCBDFB">  fetchUser</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">1</span><span style="color:#ADBAC7">),</span></span>
<span data-line=""><span style="color:#6CB6FF">  TE</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">tap</span><span style="color:#ADBAC7">(saveToCache), </span><span style="color:#768390">// 自动把 user 传给下一步，干净利落</span></span>
<span data-line=""><span style="color:#ADBAC7">);</span></span></code></pre></figure>
<ul>
<li>区分“核心逻辑”与“次要逻辑”</li>
</ul>
<p>在阅读代码时，chain 和 tap 传达的信号是完全不同的：</p>
<p>chain (flatMap)：代表 “转换”。</p>
<p>意味着这一步是业务流程的必经之路，且下一步依赖这一步产生的新数据。</p>
<p>例子：获取用户 -&gt; 根据用户ID获取订单。</p>
<p>tap：代表 “切片/观察”。</p>
<p>意味着这一步是“横插一杠子”。它告诉读者：这一步虽然可能失败（中断流程），但它不改变数据的内容。</p>
<p>例子：获取用户 -&gt; 顺便存个缓存（不改变用户数据） -&gt; 渲染页面。</p>
<ul>
<li>“铁路导轨模型”（Railroad Programming）</li>
</ul>
<p>想象一条铁路：</p>
<p>chain 是铁轨的延长线，它可能把火车导向不同的新终点。</p>
<p>tap 是铁轨上的检修站。火车开进去检查一下，如果检查不通过（Left），火车就停在检修站了；如果检查通过（Right），火车原样开出来，继续在主线行驶。</p></article><footer class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-700"><div class="flex justify-between items-center"><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-pink-900 dark:hover:text-pink-100 transition-colors" href="/blog">← 返回博客列表</a><div class="flex items-center gap-2"><span class="text-sm text-gray-500 dark:text-gray-500">标签:</span><div class="flex gap-1"><span class="text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded">TypeScript</span><span class="text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded">fp-ts</span><span class="text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded">函数式编程</span></div></div></div></footer></article></div></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-5788873a3947c2cc.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n5:I[9665,[],\"MetadataBoundary\"]\n7:I[9665,[],\"OutletBoundary\"]\na:I[4911,[],\"AsyncMetadataOutlet\"]\nc:I[9665,[],\"ViewportBoundary\"]\ne:I[6614,[],\"\"]\n:HL[\"/_next/static/media/4cf2300e9c8272f7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/b20daecae68a588f-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/de70bee13400563f.css\",\"style\"]\n:HL[\"/_next/static/css/5b223268c7b94054.css\",\"style\"]\n:HL[\"/_next/static/css/5decdc74ef1a7f94.css\",\"style\"]\n:HL[\"/_next/static/css/c21425aba4482c2f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"Rpmr4mV2alOwRs38lMxRK\",\"p\":\"\",\"c\":[\"\",\"blog\",\"fp-ts-tap\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"fp-ts-tap\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/de70bee13400563f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5b223268c7b94054.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5decdc74ef1a7f94.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_8def3f __variable_188709 __variable_9a8899 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"fp-ts-tap\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[\"$\",\"$L5\",null,{\"children\":\"$L6\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c21425aba4482c2f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"j5Fc1RNuj8nAdv0U3nEVk\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:\"$Sreact.suspense\"\n10:I[4911,[],\"AsyncMetadata\"]\n6:[\"$\",\"$f\",null,{\"fallback\":null,\"children\":[\"$\",\"$L10\",null,{\"promise\":\"$@11\"}]}]\n"])</script><script>self.__next_f.push([1,"13:I[6874,[\"874\",\"static/chunks/874-36030fac62063c21.js\",\"63\",\"static/chunks/63-5ad18c88ec2f5164.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-ca6c25fdf74e0262.js\"],\"\"]\n9:null\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto px-4 py-12\",\"children\":[\"$\",\"article\",null,{\"children\":[\"$undefined\",[\"$\",\"header\",null,{\"className\":\"mb-12\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-2 mb-6\",\"children\":[[\"$\",\"span\",\"TypeScript\",{\"className\":\"text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg\",\"children\":\"TypeScript\"}],[\"$\",\"span\",\"fp-ts\",{\"className\":\"text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg\",\"children\":\"fp-ts\"}],[\"$\",\"span\",\"函数式编程\",{\"className\":\"text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg\",\"children\":\"函数式编程\"}]]}],[\"$\",\"h1\",null,{\"className\":\"text-2xl md:text-4xl text-gray-900 dark:text-gray-100 mb-6 leading-tight\",\"children\":\"fp-ts 进阶指南：深度解析 tap 系列副作用函数\"}],[\"$\",\"p\",null,{\"className\":\"font-light text-md text-gray-600 dark:text-gray-400 leading-relaxed mb-6 italic\",\"children\":\"深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center text-sm text-gray-500 dark:text-gray-500\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2026-01-28\",\"children\":\"2026年1月28日\"}]}],[\"$\",\"div\",null,{\"className\":\"w-16 h-px bg-gray-300 dark:bg-gray-600 mt-8\"}]]}],[\"$\",\"article\",null,{\"className\":\"max-w-none prose prose-pink prose-img:rounded-lg prose-video:rounded-lg dark:prose-invert prose-a:text-foreground prose-a:decoration-6 prose-a:-underline-offset-2 prose-a:decoration-pink-300\",\"children\":\"$L12\"}],[\"$\",\"footer\",null,{\"className\":\"mt-16 pt-8 border-t border-gray-200 dark:border-gray-700\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex justify-between items-center\",\"children\":[[\"$\",\"$L13\",null,{\"href\":\"/blog\",\"className\":\"text-sm text-gray-600 dark:text-gray-400 hover:text-pink-900 dark:hover:text-pink-100 transition-colors\",\"children\":\"← 返回博客列表\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-sm text-gray-500 dark:text-gray-500\",\"children\":\"标签:\"}],[\"$\",\"div\",null,{\"className\":\"flex gap-1\",\"children\":[[\"$\",\"span\",\"TypeScript\",{\"className\":\"text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded\",\"children\":\"TypeScript\"}],[\"$\",\"span\",\"fp-ts\",{\"className\":\"text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded\",\"children\":\"fp-ts\"}],[\"$\",\"span\",\"函数式编程\",{\"className\":\"text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded\",\"children\":\"函数式编程\"}]]}]]}]]}]}]]}]}]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"11:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"fp-ts 进阶指南：深度解析 tap 系列副作用函数 | 格物致知\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。\"}],[\"$\",\"meta\",\"2\",{\"name\":\"keywords\",\"content\":\"TypeScript,fp-ts,函数式编程\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:title\",\"content\":\"fp-ts 进阶指南：深度解析 tap 系列副作用函数\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:description\",\"content\":\"深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"6\",{\"property\":\"article:published_time\",\"content\":\"2026-01-28\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"fp-ts 进阶指南：深度解析 tap 系列副作用函数\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"深入探讨 fp-ts 中 TaskEither 的 tap 系列函数，解析其核心逻辑、不同变体的应用场景，并对比 tap 与 chain 在语义化及铁路导轨模型中的差异。\"}]],\"error\":null,\"digest\":\"$undefined\"}\nb:{\"metadata\":\"$11:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"本文旨在解析 fp-ts 库中 \",[\"$\",\"code\",null,{\"children\":\"tap\"}],\" 系列函数的核心逻辑。通过对比 \",[\"$\",\"code\",null,{\"children\":\"tap\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"tapIO\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"tapTask\"}],\" 等不同变体，阐述如何在保持数据流向不变的前提下，优雅地处理同步或异步的副作用，并重点分析了 \",[\"$\",\"code\",null,{\"children\":\"tapError\"}],\" 在错误处理路径中的控制权。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"tap 系列函数的核心逻辑都是：“偷看一眼，做点副业，原样返回”。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"tap 全家桶对比表, 假设我们当前的操作流是一个 TaskEither\u003cE, A\u003e：\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"函数名称\"}],[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"针对对象\"}],[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"传入函数返回类型\"}],[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"核心用途\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tap\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"Right (成功值)\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"(a: A) =\u003e TaskEither\u003cE, A\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"最通用。执行异步操作（如存入数据库），若副作用失败，流程也转为失败。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tapIO\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"Right (成功值)\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"(a: A) =\u003e IO\u003cA\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"执行同步副作用（如 console.log、修改全局变量）。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tapTask\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"Right (成功值)\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"(a: A) =\u003e Task\u003cA\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"执行必定成功的异步副作用（如发送不关结果的统计埋点）。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tapEither\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"Right (成功值)\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"(a: A) =\u003e Either\u003cE, A\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"执行同步但可能失败的检查（如简单的参数校验）。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tapError\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"Left (错误值)\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"(e: E) =\u003e TaskEither\u003cE, A\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"针对错误执行副作用（如记录错误日志）。\"}]]}]]}]]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"谁会中断流程\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"函数\"}],[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"类型\"}],[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"异步？\"}],[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"会中断主流程吗？\"}],[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"适用场景\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tapIO\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"IO\u003cA\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"否\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"不会\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"写日志、读本地配置\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tapEither\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"Either\u003cE, A\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"否\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"会 (若返回 Left)\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"同步校验、业务规则检查\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tapTask\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"Task\u003cA\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"是\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"不会\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"后台统计、非关键性通知\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"tap\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"TaskEither\u003cE, A\u003e\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"是\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"会 (若返回 Left)\"}],[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"left\"},\"children\":\"存数据库、调用第三方支付 API\"}]]}]]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Q: 为什么tapError要返回 TaskEither， 为什么不能像tapTask那样?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A: 这里有一个微妙的逻辑：tapError 虽然不能把“失败”变回“成功”，但它有权决定“失败的原因是否要升级或改变”\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"在函数式编程中，我们追求对错误路径的极端控制。请看这个场景\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"场景：数据库连接失败（原始错误）。\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"副作用：我们希望 LoggerService 把这个错误存到远程日志服务器。\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"新问题：如果此时远程日志服务器也挂了，该怎么办？\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"通过返回 TaskEither，tapError 允许：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"保持原样：如果日志记录成功，传出的依然是原始的“数据库连接失败”。\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"替换错误：如果日志记录也失败了，可以选择抛出一个更严重的错误（例如：数据库失败且日志系统宕机）。\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Q: 像tapEither和tap即tapTaskEither, 他们返回Either\u003cE,A\u003e 或者TaskEither\u003cE,A\u003e, 都可以中断业务流程 那我们为什么不直接通过flatMap 或者chainW 来把它chain到进主流程呢, 该如何理解呢?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A: 简单直接的答案是：语义化（Semantics） 和 代码组合性（Composability）\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"虽然 flatMap (在 fp-ts 中叫 chain) 确实可以实现 tap 的所有功能，但使用 tap 系列函数有以下三个不可替代的理由\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"保护“主干数据”不被破坏, 这是最实际的理由。tap 的逻辑是：输入是什么，输出就必须是什么。\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"使用 chain：如果你只是想在中间存个数据库，用 chain 的话，你必须手动在函数最后把原始数据返回，否则下一步就拿不到数据了。\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"ts\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"ts\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"typescript;\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"pipe\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  fetchUser\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"  TE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"chain\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"user\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    pipe\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"      saveToCache\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(user), \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 返回 TE.right(void)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      TE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" user), \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 你必须手动把 user 传下去，极其啰嗦\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    ),\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  ),\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"使用 tap：它自动帮你把输入传递给输出，只需要关注副作用本身\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"ts\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"ts\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"pipe\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  fetchUser\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"  TE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"tap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(saveToCache), \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 自动把 user 传给下一步，干净利落\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"区分“核心逻辑”与“次要逻辑”\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"在阅读代码时，chain 和 tap 传达的信号是完全不同的：\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"chain (flatMap)：代表 “转换”。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"意味着这一步是业务流程的必经之路，且下一步依赖这一步产生的新数据。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"例子：获取用户 -\u003e 根据用户ID获取订单。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"tap：代表 “切片/观察”。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"意味着这一步是“横插一杠子”。它告诉读者：这一步虽然可能失败（中断流程），但它不改变数据的内容。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"例子：获取用户 -\u003e 顺便存个缓存（不改变用户数据） -\u003e 渲染页面。\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"“铁路导轨模型”（Railroad Programming）\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"想象一条铁路：\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"chain 是铁轨的延长线，它可能把火车导向不同的新终点。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"tap 是铁轨上的检修站。火车开进去检查一下，如果检查不通过（Left），火车就停在检修站了；如果检查通过（Right），火车原样开出来，继续在主线行驶。\"}]]\n"])</script></body></html>