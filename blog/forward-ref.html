<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/7833d2e2b2ee9543-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/forward-ref.png"/><link rel="stylesheet" href="/_next/static/css/f30152c0704fba31.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/2afc3194b07f38f2.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/e43cec86237bbee5.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/0e4ee5feb628e00d.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-5788873a3947c2cc.js"/><script src="/_next/static/chunks/4bd1b696-18452535c1c4862d.js" async=""></script><script src="/_next/static/chunks/684-a40553b8f97e5ad6.js" async=""></script><script src="/_next/static/chunks/main-app-08d8e87f5b019b96.js" async=""></script><script src="/_next/static/chunks/874-36030fac62063c21.js" async=""></script><script src="/_next/static/chunks/63-5ad18c88ec2f5164.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-ca6c25fdf74e0262.js" async=""></script><meta name="next-size-adjust" content=""/><title>forwardRef | 格物致知</title><meta name="description" content="P -&gt; C -&gt; DOM的ref 传递器"/><meta name="keywords" content="React forwardRef,React Hooks,useImperativeHandle,ref forwarding,组件设计,React 进阶,前端架构,组件封装,TypeScript React"/><meta property="og:title" content="forwardRef"/><meta property="og:description" content="P -&gt; C -&gt; DOM的ref 传递器"/><meta property="og:image" content="http://localhost:3000/forward-ref.png"/><meta property="og:image:alt" content="forwardRef"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2022-12-19"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="forwardRef"/><meta name="twitter:description" content="P -&gt; C -&gt; DOM的ref 传递器"/><meta name="twitter:image" content="http://localhost:3000/forward-ref.png"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_5e6612 __variable_5cfdac __variable_9a8899 antialiased"><div class="min-h-screen bg-background text-foreground"><div class="max-w-2xl mx-auto px-4 py-12"><article><div class="relative w-full h-64 md:h-96 mb-8 rounded-lg overflow-hidden"><img alt="forwardRef" decoding="async" data-nimg="fill" class="object-cover dark:invert" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/forward-ref.png"/></div><header class="mb-12"><div class="flex flex-wrap gap-2 mb-6"><span class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg">React</span><span class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg">forwardRef</span><span class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg">Hooks</span><span class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg">Component Design</span></div><h1 class="text-2xl md:text-4xl text-gray-900 dark:text-gray-100 mb-6 leading-tight">forwardRef</h1><p class="font-light text-md text-gray-600 dark:text-gray-400 leading-relaxed mb-6 italic">P -&gt; C -&gt; DOM的ref 传递器</p><div class="flex items-center text-sm text-gray-500 dark:text-gray-500"><time dateTime="2022-12-19">2022年12月19日</time></div><div class="w-16 h-px bg-gray-300 dark:bg-gray-600 mt-8"></div></header><article class="max-w-none prose prose-pink prose-img:rounded-lg prose-video:rounded-lg dark:prose-invert prose-a:text-foreground prose-a:decoration-6 prose-a:-underline-offset-2 prose-a:decoration-pink-300"><p>前两天，我在开发一个表单组件库时遇到了一个看似简单的需求：产品经理希望能够在点击submit button后聚焦到第一个验证出错的输入框。听起来很简单，对吧？</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 最初的想法</span></span>
<span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> MyForm</span><span style="color:#ADBAC7">() {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> inputRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#DCBDFB"> handleFocus</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#ADBAC7">    inputRef.current.</span><span style="color:#DCBDFB">focus</span><span style="color:#ADBAC7">(); </span><span style="color:#768390">// 简单粗暴</span></span>
<span data-line=""><span style="color:#ADBAC7">  };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">CustomInput</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">inputRef</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">button</span><span style="color:#6CB6FF"> onClick</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">handleFocus</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&gt;聚焦输入框&lt;/</span><span style="color:#8DDB8C">button</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;/</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">  );</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span></code></pre></figure>
<p>但是当我实际运行代码时，却得到了一个让我困惑的错误：</p>
<pre><code>Warning: Function components cannot be given refs.
Attempts to access this ref will fail.
</code></pre>
<p>啥玩意?</p>
<h3>问题的根源：Ref 传递的困境</h3>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Parent Component</mtext><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext>ref</mtext></mpadded></mover><mtext>Child Component</mtext><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mpadded></mover><mtext>DOM Element</mtext></mrow><annotation encoding="application/x-tex">\text{Parent Component} \xrightarrow{\text{ref}} \text{Child Component} \xrightarrow{?} \text{DOM Element}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3025em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">Parent Component</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ref</span></span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3025em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">Child Component</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">DOM Element</span></span></span></span></span></span>
<p>在 React 中，ref 不会自动传递给函数组件的内部元素。这是因为：</p>
<ol>
<li><strong>函数组件没有实例</strong>：与类组件不同，函数组件没有实例可以被 ref 引用</li>
<li><strong>ref 不是 prop</strong>：ref 是一个特殊的属性，不会出现在 props 中</li>
<li><strong>封装性原则</strong>：React 希望组件的内部实现是封装的</li>
</ol>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 这个组件接收不到 ref</span></span>
<span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> CustomInput</span><span style="color:#ADBAC7">({ </span><span style="color:#F69D50">placeholder</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">...</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7"> }) {</span></span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">input</span><span style="color:#6CB6FF"> placeholder</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">placeholder</span><span style="color:#F47067">}</span><span style="color:#F47067"> {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 父组件的 ref 传递失败</span></span>
<span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> App</span><span style="color:#ADBAC7">() {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> inputRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">CustomInput</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">inputRef</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;; </span><span style="color:#768390">// ❌ 不会工作</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span></code></pre></figure>
<h3>forwardRef 登场</h3>
<p><strong>forwardRef</strong> 就像是一个&quot;ref 传递器&quot;，它让我们能够将 ref 从父组件传递到子组件的内部 DOM 元素：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 使用 forwardRef 包装组件</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> CustomInput</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">input</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span><span style="color:#F47067"> {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 现在可以正常工作了</span></span>
<span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> App</span><span style="color:#ADBAC7">() {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> inputRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#DCBDFB"> handleFocus</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#ADBAC7">    inputRef.current?.</span><span style="color:#DCBDFB">focus</span><span style="color:#ADBAC7">(); </span><span style="color:#768390">// ✅ 成功！</span></span>
<span data-line=""><span style="color:#ADBAC7">  };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">CustomInput</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">inputRef</span><span style="color:#F47067">}</span><span style="color:#6CB6FF"> placeholder</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;请输入内容&quot;</span><span style="color:#ADBAC7"> /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">button</span><span style="color:#6CB6FF"> onClick</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">handleFocus</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&gt;聚焦输入框&lt;/</span><span style="color:#8DDB8C">button</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;/</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">  );</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span></code></pre></figure>
<h3>深入理解 forwardRef 的工作原理</h3>
<h4>1. 函数签名的变化</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 普通函数组件</span></span>
<span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> Component</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;</span><span style="color:#F47067">{</span><span style="color:#ADBAC7">props.children</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&lt;/</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// forwardRef 包装后的组件</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> Component</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&gt;</span><span style="color:#F47067">{</span><span style="color:#ADBAC7">props.children</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&lt;/</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">});</span></span></code></pre></figure>
<p>关键变化：</p>
<ul>
<li>第二个参数 <code>ref</code> 被显式传入</li>
<li>可以将 <code>ref</code> 传递给任何内部元素</li>
<li>组件的调用方式不变</li>
</ul>
<h4>2. TypeScript 中的类型定义</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="tsx" data-theme="github-dark-dimmed"><code data-language="tsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 定义 props 类型</span></span>
<span data-line=""><span style="color:#F47067">interface</span><span style="color:#F69D50"> CustomInputProps</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F69D50">  placeholder</span><span style="color:#F47067">?:</span><span style="color:#6CB6FF"> string</span><span style="color:#ADBAC7">;</span></span>
<span data-line=""><span style="color:#F69D50">  disabled</span><span style="color:#F47067">?:</span><span style="color:#6CB6FF"> boolean</span><span style="color:#ADBAC7">;</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 使用 forwardRef 的正确类型定义</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> CustomInput</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">&lt;</span><span style="color:#F69D50">HTMLInputElement</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">CustomInputProps</span><span style="color:#ADBAC7">&gt;(</span></span>
<span data-line=""><span style="color:#ADBAC7">  ({ </span><span style="color:#F69D50">placeholder</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">disabled</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">...</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7"> }, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">input</span></span>
<span data-line=""><span style="color:#6CB6FF">        ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">        placeholder</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">placeholder</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">        disabled</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">disabled</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#F47067">        {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#ADBAC7">      /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">    );</span></span>
<span data-line=""><span style="color:#ADBAC7">  },</span></span>
<span data-line=""><span style="color:#ADBAC7">);</span></span></code></pre></figure>
<h3>经典使用场景分析</h3>
<h4>1. 表单控件封装</h4>
<p>这是我在工作中最常遇到的场景：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 封装一个带验证的输入框</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> ValidatedInput</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">(</span></span>
<span data-line=""><span style="color:#ADBAC7">  ({ </span><span style="color:#F69D50">label</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">error</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">validation</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">...</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7"> }, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">    const</span><span style="color:#ADBAC7"> [</span><span style="color:#6CB6FF">isValid</span><span style="color:#ADBAC7">, </span><span style="color:#6CB6FF">setIsValid</span><span style="color:#ADBAC7">] </span><span style="color:#F47067">=</span><span style="color:#DCBDFB"> useState</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">true</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">    const</span><span style="color:#DCBDFB"> handleBlur</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> (</span><span style="color:#F69D50">e</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">      if</span><span style="color:#ADBAC7"> (validation) {</span></span>
<span data-line=""><span style="color:#F47067">        const</span><span style="color:#6CB6FF"> valid</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> validation</span><span style="color:#ADBAC7">(e.target.value);</span></span>
<span data-line=""><span style="color:#DCBDFB">        setIsValid</span><span style="color:#ADBAC7">(valid);</span></span>
<span data-line=""><span style="color:#ADBAC7">      }</span></span>
<span data-line=""><span style="color:#ADBAC7">      props.</span><span style="color:#DCBDFB">onBlur</span><span style="color:#ADBAC7">?.(e);</span></span>
<span data-line=""><span style="color:#ADBAC7">    };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#6CB6FF"> className</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;form-field&quot;</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">        &lt;</span><span style="color:#8DDB8C">label</span><span style="color:#ADBAC7">&gt;</span><span style="color:#F47067">{</span><span style="color:#ADBAC7">label</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&lt;/</span><span style="color:#8DDB8C">label</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">        &lt;</span><span style="color:#8DDB8C">input</span></span>
<span data-line=""><span style="color:#6CB6FF">          ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#F47067">          {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">          onBlur</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">handleBlur</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">          className</span><span style="color:#F47067">={</span><span style="color:#96D0FF">`input ${</span><span style="color:#F47067">!</span><span style="color:#ADBAC7">isValid</span><span style="color:#F47067"> ?</span><span style="color:#96D0FF"> &quot;error&quot;</span><span style="color:#F47067"> :</span><span style="color:#96D0FF"> &quot;&quot;}`</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#ADBAC7">        /&gt;</span></span>
<span data-line=""><span style="color:#F47067">        {</span><span style="color:#ADBAC7">error </span><span style="color:#F47067">&amp;&amp;</span><span style="color:#F47067"> !</span><span style="color:#ADBAC7">isValid </span><span style="color:#F47067">&amp;&amp;</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">span</span><span style="color:#6CB6FF"> className</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;error-text&quot;</span><span style="color:#ADBAC7">&gt;</span><span style="color:#F47067">{</span><span style="color:#ADBAC7">error</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&lt;/</span><span style="color:#8DDB8C">span</span><span style="color:#ADBAC7">&gt;</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;/</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">    );</span></span>
<span data-line=""><span style="color:#ADBAC7">  },</span></span>
<span data-line=""><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 使用方式</span></span>
<span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> LoginForm</span><span style="color:#ADBAC7">() {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> emailRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> passwordRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#DCBDFB"> handleSubmit</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#768390">    // 可以直接访问原生 DOM 方法</span></span>
<span data-line=""><span style="color:#F47067">    if</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">!</span><span style="color:#ADBAC7">emailRef.current.value) {</span></span>
<span data-line=""><span style="color:#ADBAC7">      emailRef.current.</span><span style="color:#DCBDFB">focus</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""><span style="color:#F47067">      return</span><span style="color:#ADBAC7">;</span></span>
<span data-line=""><span style="color:#ADBAC7">    }</span></span>
<span data-line=""><span style="color:#768390">    // 提交逻辑...</span></span>
<span data-line=""><span style="color:#ADBAC7">  };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;</span><span style="color:#8DDB8C">form</span><span style="color:#6CB6FF"> onSubmit</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">handleSubmit</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">ValidatedInput</span></span>
<span data-line=""><span style="color:#6CB6FF">        ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">emailRef</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">        label</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;邮箱&quot;</span></span>
<span data-line=""><span style="color:#6CB6FF">        type</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;email&quot;</span></span>
<span data-line=""><span style="color:#6CB6FF">        validation</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">value</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#96D0FF"> /</span><span style="color:#6CB6FF">\S</span><span style="color:#F47067">+</span><span style="color:#96D0FF">@</span><span style="color:#6CB6FF">\S</span><span style="color:#F47067">+</span><span style="color:#8DDB8C;font-weight:bold">\.</span><span style="color:#6CB6FF">\S</span><span style="color:#F47067">+</span><span style="color:#96D0FF">/</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">test</span><span style="color:#ADBAC7">(value)</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">        error</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;请输入有效的邮箱地址&quot;</span></span>
<span data-line=""><span style="color:#ADBAC7">      /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">ValidatedInput</span></span>
<span data-line=""><span style="color:#6CB6FF">        ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">passwordRef</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">        label</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;密码&quot;</span></span>
<span data-line=""><span style="color:#6CB6FF">        type</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;password&quot;</span></span>
<span data-line=""><span style="color:#6CB6FF">        validation</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">value</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> value.</span><span style="color:#6CB6FF">length</span><span style="color:#F47067"> &gt;=</span><span style="color:#6CB6FF"> 6</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">        error</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;密码至少6位&quot;</span></span>
<span data-line=""><span style="color:#ADBAC7">      /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">button</span><span style="color:#6CB6FF"> type</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;submit&quot;</span><span style="color:#ADBAC7">&gt;登录&lt;/</span><span style="color:#8DDB8C">button</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;/</span><span style="color:#8DDB8C">form</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">  );</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span></code></pre></figure>
<h4>2. 第三方库的集成</h4>
<p>当我们需要集成第三方库时，forwardRef 特别有用：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 封装一个基于第三方库的组件</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> RichTextEditor</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">(</span></span>
<span data-line=""><span style="color:#ADBAC7">  ({ </span><span style="color:#F69D50">initialValue</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">onContentChange</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">...</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7"> }, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">    const</span><span style="color:#6CB6FF"> editorRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">    // 使用 useImperativeHandle 暴露特定方法</span></span>
<span data-line=""><span style="color:#DCBDFB">    useImperativeHandle</span><span style="color:#ADBAC7">(ref, () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> ({</span></span>
<span data-line=""><span style="color:#DCBDFB">      focus</span><span style="color:#ADBAC7">: () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> editorRef.current?.</span><span style="color:#DCBDFB">focus</span><span style="color:#ADBAC7">(),</span></span>
<span data-line=""><span style="color:#DCBDFB">      getContent</span><span style="color:#ADBAC7">: () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> editorRef.current?.</span><span style="color:#DCBDFB">getContent</span><span style="color:#ADBAC7">(),</span></span>
<span data-line=""><span style="color:#DCBDFB">      setContent</span><span style="color:#ADBAC7">: (</span><span style="color:#F69D50">content</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> editorRef.current?.</span><span style="color:#DCBDFB">setContent</span><span style="color:#ADBAC7">(content),</span></span>
<span data-line=""><span style="color:#DCBDFB">      insertText</span><span style="color:#ADBAC7">: (</span><span style="color:#F69D50">text</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> editorRef.current?.</span><span style="color:#DCBDFB">insertText</span><span style="color:#ADBAC7">(text),</span></span>
<span data-line=""><span style="color:#ADBAC7">    }));</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#DCBDFB">    useEffect</span><span style="color:#ADBAC7">(() </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#768390">      // 初始化第三方编辑器</span></span>
<span data-line=""><span style="color:#F47067">      const</span><span style="color:#6CB6FF"> editor</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#DCBDFB"> ThirdPartyEditor</span><span style="color:#ADBAC7">(editorRef.current, {</span></span>
<span data-line=""><span style="color:#ADBAC7">        initialValue,</span></span>
<span data-line=""><span style="color:#ADBAC7">        onChange: onContentChange,</span></span>
<span data-line=""><span style="color:#F47067">        ...</span><span style="color:#ADBAC7">props,</span></span>
<span data-line=""><span style="color:#ADBAC7">      });</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">      return</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> editor.</span><span style="color:#DCBDFB">destroy</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""><span style="color:#ADBAC7">    }, []);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">editorRef</span><span style="color:#F47067">}</span><span style="color:#6CB6FF"> className</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;rich-editor&quot;</span><span style="color:#ADBAC7"> /&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">  },</span></span>
<span data-line=""><span style="color:#ADBAC7">);</span></span></code></pre></figure>
<h4>3. 动画库的集成</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 封装一个带动画的组件</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> AnimatedCard</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">(</span></span>
<span data-line=""><span style="color:#ADBAC7">  ({ </span><span style="color:#F69D50">children</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">animationType</span><span style="color:#F47067"> =</span><span style="color:#96D0FF"> &quot;fade&quot;</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">...</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7"> }, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">    const</span><span style="color:#6CB6FF"> cardRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">    // 组合 refs</span></span>
<span data-line=""><span style="color:#F47067">    const</span><span style="color:#6CB6FF"> combinedRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useMemo</span><span style="color:#ADBAC7">(() </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">      if</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">!</span><span style="color:#ADBAC7">ref) </span><span style="color:#F47067">return</span><span style="color:#ADBAC7"> cardRef;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">      return</span><span style="color:#ADBAC7"> (</span><span style="color:#F69D50">node</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#ADBAC7">        cardRef.current </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> node;</span></span>
<span data-line=""><span style="color:#F47067">        if</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">typeof</span><span style="color:#ADBAC7"> ref </span><span style="color:#F47067">===</span><span style="color:#96D0FF"> &quot;function&quot;</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""><span style="color:#DCBDFB">          ref</span><span style="color:#ADBAC7">(node);</span></span>
<span data-line=""><span style="color:#ADBAC7">        } </span><span style="color:#F47067">else</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#ADBAC7">          ref.current </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> node;</span></span>
<span data-line=""><span style="color:#ADBAC7">        }</span></span>
<span data-line=""><span style="color:#ADBAC7">      };</span></span>
<span data-line=""><span style="color:#ADBAC7">    }, [ref]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#DCBDFB">    useEffect</span><span style="color:#ADBAC7">(() </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#768390">      // 使用动画库</span></span>
<span data-line=""><span style="color:#F47067">      const</span><span style="color:#6CB6FF"> animation</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> gsap.</span><span style="color:#DCBDFB">from</span><span style="color:#ADBAC7">(cardRef.current, {</span></span>
<span data-line=""><span style="color:#ADBAC7">        opacity: </span><span style="color:#6CB6FF">0</span><span style="color:#ADBAC7">,</span></span>
<span data-line=""><span style="color:#ADBAC7">        y: </span><span style="color:#6CB6FF">20</span><span style="color:#ADBAC7">,</span></span>
<span data-line=""><span style="color:#ADBAC7">        duration: </span><span style="color:#6CB6FF">0.3</span><span style="color:#ADBAC7">,</span></span>
<span data-line=""><span style="color:#ADBAC7">      });</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">      return</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> animation.</span><span style="color:#DCBDFB">kill</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""><span style="color:#ADBAC7">    }, []);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">combinedRef</span><span style="color:#F47067">}</span><span style="color:#6CB6FF"> className</span><span style="color:#F47067">=</span><span style="color:#96D0FF">&quot;animated-card&quot;</span><span style="color:#F47067"> {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#F47067">        {</span><span style="color:#ADBAC7">children</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#ADBAC7">      &lt;/</span><span style="color:#8DDB8C">div</span><span style="color:#ADBAC7">&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">    );</span></span>
<span data-line=""><span style="color:#ADBAC7">  },</span></span>
<span data-line=""><span style="color:#ADBAC7">);</span></span></code></pre></figure>
<h3>forwardRef 的适用范围</h3>
<h4>✅ 适用场景</h4>
<ol>
<li><strong>UI 组件库开发</strong>：需要暴露底层 DOM 元素的方法</li>
<li><strong>表单控件封装</strong>：需要访问原生表单元素</li>
<li><strong>第三方库集成</strong>：需要将 ref 传递给第三方组件</li>
<li><strong>动画控制</strong>：需要直接操作 DOM 进行动画</li>
<li><strong>焦点管理</strong>：需要程序化控制焦点</li>
</ol>
<h4>❌ 不适用场景</h4>
<ol>
<li><strong>简单的数据展示组件</strong>：不需要 DOM 操作</li>
<li><strong>纯函数式组件</strong>：没有副作用的组件</li>
<li><strong>高频重渲染组件</strong>：forwardRef 会增加少量性能开销</li>
<li><strong>内部状态管理</strong>：应该使用 props 和 state</li>
</ol>
<h3>相关概念深度解析</h3>
<h4>1. useImperativeHandle：精确控制暴露接口</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> CustomInput</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> inputRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#ADBAC7"> [</span><span style="color:#6CB6FF">value</span><span style="color:#ADBAC7">, </span><span style="color:#6CB6FF">setValue</span><span style="color:#ADBAC7">] </span><span style="color:#F47067">=</span><span style="color:#DCBDFB"> useState</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;&quot;</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">  // 只暴露特定的方法，而不是整个 DOM 元素</span></span>
<span data-line=""><span style="color:#DCBDFB">  useImperativeHandle</span><span style="color:#ADBAC7">(ref, () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> ({</span></span>
<span data-line=""><span style="color:#DCBDFB">    focus</span><span style="color:#ADBAC7">: () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> inputRef.current?.</span><span style="color:#DCBDFB">focus</span><span style="color:#ADBAC7">(),</span></span>
<span data-line=""><span style="color:#DCBDFB">    clear</span><span style="color:#ADBAC7">: () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#DCBDFB">      setValue</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;&quot;</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""><span style="color:#ADBAC7">      inputRef.current?.</span><span style="color:#DCBDFB">focus</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""><span style="color:#ADBAC7">    },</span></span>
<span data-line=""><span style="color:#DCBDFB">    getValue</span><span style="color:#ADBAC7">: () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> value,</span></span>
<span data-line=""><span style="color:#DCBDFB">    setValue</span><span style="color:#ADBAC7">: (</span><span style="color:#F69D50">newValue</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#DCBDFB"> setValue</span><span style="color:#ADBAC7">(newValue),</span></span>
<span data-line=""><span style="color:#768390">    // 不暴露原生 DOM 元素的其他方法</span></span>
<span data-line=""><span style="color:#ADBAC7">  }));</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;</span><span style="color:#8DDB8C">input</span></span>
<span data-line=""><span style="color:#6CB6FF">      ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">inputRef</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">      value</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">value</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">      onChange</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">e</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#DCBDFB"> setValue</span><span style="color:#ADBAC7">(e.target.value)</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#F47067">      {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#ADBAC7">    /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">  );</span></span>
<span data-line=""><span style="color:#ADBAC7">});</span></span></code></pre></figure>
<h4>2. Ref 的多种类型</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 1. useRef 创建的 ref</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> myRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 2. createRef 创建的 ref（类组件中）</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> myRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> createRef</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 3. 回调 ref</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> myRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useCallback</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">node</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">  if</span><span style="color:#ADBAC7"> (node) {</span></span>
<span data-line=""><span style="color:#768390">    // DOM 元素挂载时的逻辑</span></span>
<span data-line=""><span style="color:#ADBAC7">    node.</span><span style="color:#DCBDFB">focus</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""><span style="color:#ADBAC7">  }</span></span>
<span data-line=""><span style="color:#ADBAC7">}, []);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 4. 字符串 ref（已废弃，不推荐）</span></span>
<span data-line=""><span style="color:#768390">// &lt;div ref=&quot;myRef&quot; /&gt;</span></span></code></pre></figure>
<h4>3. Ref 的组合和传递</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 高阶组件中的 ref 传递</span></span>
<span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> withLogging</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">WrappedComponent</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> WithLoggingComponent</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">    const</span><span style="color:#DCBDFB"> logProps</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#ADBAC7">      console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;Props:&quot;</span><span style="color:#ADBAC7">, props);</span></span>
<span data-line=""><span style="color:#ADBAC7">    };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">WrappedComponent</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span><span style="color:#F47067"> {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span><span style="color:#6CB6FF"> onFocus</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">logProps</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">  });</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">  WithLoggingComponent.displayName </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> `withLogging(${</span><span style="color:#ADBAC7">WrappedComponent</span><span style="color:#96D0FF">.</span><span style="color:#ADBAC7">displayName</span><span style="color:#F47067"> ||</span><span style="color:#ADBAC7"> WrappedComponent</span><span style="color:#96D0FF">.</span><span style="color:#ADBAC7">name</span><span style="color:#96D0FF">})`</span><span style="color:#ADBAC7">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> WithLoggingComponent;</span></span>
<span data-line=""><span style="color:#ADBAC7">}</span></span></code></pre></figure>
<h3>实际项目中的最佳实践</h3>
<h4>1. 组件库的设计模式</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// 基础组件</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> BaseInput</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">(({ </span><span style="color:#F69D50">className</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">...</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7"> }, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;</span><span style="color:#8DDB8C">input</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span><span style="color:#6CB6FF"> className</span><span style="color:#F47067">={</span><span style="color:#96D0FF">`base-input ${</span><span style="color:#ADBAC7">className</span><span style="color:#F47067"> ||</span><span style="color:#96D0FF"> &quot;&quot;}`</span><span style="color:#F47067">}</span><span style="color:#F47067"> {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">  );</span></span>
<span data-line=""><span style="color:#ADBAC7">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 扩展组件</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> SearchInput</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">(({ </span><span style="color:#F69D50">onSearch</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">...</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7"> }, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#ADBAC7"> [</span><span style="color:#6CB6FF">searchTerm</span><span style="color:#ADBAC7">, </span><span style="color:#6CB6FF">setSearchTerm</span><span style="color:#ADBAC7">] </span><span style="color:#F47067">=</span><span style="color:#DCBDFB"> useState</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;&quot;</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#DCBDFB"> handleKeyPress</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> (</span><span style="color:#F69D50">e</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">    if</span><span style="color:#ADBAC7"> (e.key </span><span style="color:#F47067">===</span><span style="color:#96D0FF"> &quot;Enter&quot;</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""><span style="color:#DCBDFB">      onSearch</span><span style="color:#ADBAC7">?.(searchTerm);</span></span>
<span data-line=""><span style="color:#ADBAC7">    }</span></span>
<span data-line=""><span style="color:#ADBAC7">  };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> (</span></span>
<span data-line=""><span style="color:#ADBAC7">    &lt;</span><span style="color:#8DDB8C">BaseInput</span></span>
<span data-line=""><span style="color:#6CB6FF">      ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">      value</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">searchTerm</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">      onChange</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">e</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#DCBDFB"> setSearchTerm</span><span style="color:#ADBAC7">(e.target.value)</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#6CB6FF">      onKeyPress</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">handleKeyPress</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#F47067">      {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span></span>
<span data-line=""><span style="color:#ADBAC7">    /&gt;</span></span>
<span data-line=""><span style="color:#ADBAC7">  );</span></span>
<span data-line=""><span style="color:#ADBAC7">});</span></span></code></pre></figure>
<h4>2. 错误处理和边界情况</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> SafeForwardRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> forwardRef</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> localRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">  // 安全的 ref 处理</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> safeRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useMemo</span><span style="color:#ADBAC7">(() </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">    if</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">!</span><span style="color:#ADBAC7">ref) </span><span style="color:#F47067">return</span><span style="color:#ADBAC7"> localRef;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> (</span><span style="color:#F69D50">node</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#ADBAC7">      localRef.current </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> node;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">      try</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#F47067">        if</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">typeof</span><span style="color:#ADBAC7"> ref </span><span style="color:#F47067">===</span><span style="color:#96D0FF"> &quot;function&quot;</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""><span style="color:#DCBDFB">          ref</span><span style="color:#ADBAC7">(node);</span></span>
<span data-line=""><span style="color:#ADBAC7">        } </span><span style="color:#F47067">else</span><span style="color:#F47067"> if</span><span style="color:#ADBAC7"> (ref </span><span style="color:#F47067">&amp;&amp;</span><span style="color:#F47067"> typeof</span><span style="color:#ADBAC7"> ref </span><span style="color:#F47067">===</span><span style="color:#96D0FF"> &quot;object&quot;</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""><span style="color:#ADBAC7">          ref.current </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> node;</span></span>
<span data-line=""><span style="color:#ADBAC7">        }</span></span>
<span data-line=""><span style="color:#ADBAC7">      } </span><span style="color:#F47067">catch</span><span style="color:#ADBAC7"> (error) {</span></span>
<span data-line=""><span style="color:#ADBAC7">        console.</span><span style="color:#DCBDFB">error</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;Ref assignment failed:&quot;</span><span style="color:#ADBAC7">, error);</span></span>
<span data-line=""><span style="color:#ADBAC7">      }</span></span>
<span data-line=""><span style="color:#ADBAC7">    };</span></span>
<span data-line=""><span style="color:#ADBAC7">  }, [ref]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">safeRef</span><span style="color:#F47067">}</span><span style="color:#F47067"> {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">});</span></span></code></pre></figure>
<h3>性能考虑</h3>
<h4>forwardRef 的性能影响</h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="jsx" data-theme="github-dark-dimmed"><code data-language="jsx" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#768390">// forwardRef 本身的性能开销很小</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> MemoizedComponent</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> memo</span><span style="color:#ADBAC7">(</span></span>
<span data-line=""><span style="color:#DCBDFB">  forwardRef</span><span style="color:#ADBAC7">((</span><span style="color:#F69D50">props</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ref</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#768390">    // 组件逻辑</span></span>
<span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">div</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">ref</span><span style="color:#F47067">}</span><span style="color:#F47067"> {...</span><span style="color:#ADBAC7">props</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">  }),</span></span>
<span data-line=""><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">// 但要注意避免不必要的重新创建</span></span>
<span data-line=""><span style="color:#F47067">const</span><span style="color:#DCBDFB"> ParentComponent</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""><span style="color:#768390">  // ❌ 每次渲染都会创建新的 ref</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#DCBDFB"> createRef</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> () </span><span style="color:#F47067">=&gt;</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">  // ✅ 正确的做法</span></span>
<span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> stableRef</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> useRef</span><span style="color:#ADBAC7">(</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">  return</span><span style="color:#ADBAC7"> &lt;</span><span style="color:#8DDB8C">MemoizedComponent</span><span style="color:#6CB6FF"> ref</span><span style="color:#F47067">={</span><span style="color:#ADBAC7">stableRef</span><span style="color:#F47067">}</span><span style="color:#ADBAC7"> /&gt;;</span></span>
<span data-line=""><span style="color:#ADBAC7">};</span></span></code></pre></figure>
<h3>总结</h3>
<p>forwardRef 使用原则：</p>
<ol>
<li><strong>最小暴露原则</strong>：只暴露必要的接口，使用 <code>useImperativeHandle</code> 精确控制</li>
<li><strong>类型安全</strong>：在 TypeScript 中明确定义 ref 类型</li>
<li><strong>向后兼容</strong>：设计 API 时考虑未来的扩展性</li>
<li><strong>错误处理</strong>：优雅地处理 ref 传递中的异常情况</li>
</ol></article><footer class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-700"><div class="flex justify-between items-center"><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-pink-900 dark:hover:text-pink-100 transition-colors" href="/blog">← 返回博客列表</a><div class="flex items-center gap-2"><span class="text-sm text-gray-500 dark:text-gray-500">标签:</span><div class="flex gap-1"><span class="text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded">React</span><span class="text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded">forwardRef</span><span class="text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded">Hooks</span><span class="text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded">Component Design</span></div></div></div></footer></article></div></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-5788873a3947c2cc.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n5:I[9665,[],\"MetadataBoundary\"]\n7:I[9665,[],\"OutletBoundary\"]\na:I[4911,[],\"AsyncMetadataOutlet\"]\nc:I[9665,[],\"ViewportBoundary\"]\ne:I[6614,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/7833d2e2b2ee9543-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/f30152c0704fba31.css\",\"style\"]\n:HL[\"/_next/static/css/2afc3194b07f38f2.css\",\"style\"]\n:HL[\"/_next/static/css/e43cec86237bbee5.css\",\"style\"]\n:HL[\"/_next/static/css/0e4ee5feb628e00d.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"hOntHNDs3BpwYeuCyCPtQ\",\"p\":\"\",\"c\":[\"\",\"blog\",\"forward-ref\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"forward-ref\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f30152c0704fba31.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2afc3194b07f38f2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/e43cec86237bbee5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_5e6612 __variable_5cfdac __variable_9a8899 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"forward-ref\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[\"$\",\"$L5\",null,{\"children\":\"$L6\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0e4ee5feb628e00d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"c0T7_qHNTN4gaUvaVQ_FU\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:\"$Sreact.suspense\"\n10:I[4911,[],\"AsyncMetadata\"]\n6:[\"$\",\"$f\",null,{\"fallback\":null,\"children\":[\"$\",\"$L10\",null,{\"promise\":\"$@11\"}]}]\n"])</script><script>self.__next_f.push([1,"12:I[3565,[\"874\",\"static/chunks/874-36030fac62063c21.js\",\"63\",\"static/chunks/63-5ad18c88ec2f5164.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-ca6c25fdf74e0262.js\"],\"ImageWithFallback\"]\n14:I[6874,[\"874\",\"static/chunks/874-36030fac62063c21.js\",\"63\",\"static/chunks/63-5ad18c88ec2f5164.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-ca6c25fdf74e0262.js\"],\"\"]\n9:null\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto px-4 py-12\",\"children\":[\"$\",\"article\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"relative w-full h-64 md:h-96 mb-8 rounded-lg overflow-hidden\",\"children\":[\"$\",\"$L12\",null,{\"src\":\"/forward-ref.png\",\"alt\":\"forwardRef\",\"fill\":true,\"sizes\":\"width: 100vw; height: auto\",\"className\":\"object-cover dark:invert\",\"priority\":true,\"fallbackSrc\":\"/missing-image.svg\"}]}],[\"$\",\"header\",null,{\"className\":\"mb-12\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-2 mb-6\",\"children\":[[\"$\",\"span\",\"React\",{\"className\":\"text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg\",\"children\":\"React\"}],[\"$\",\"span\",\"forwardRef\",{\"className\":\"text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg\",\"children\":\"forwardRef\"}],[\"$\",\"span\",\"Hooks\",{\"className\":\"text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg\",\"children\":\"Hooks\"}],[\"$\",\"span\",\"Component Design\",{\"className\":\"text-xs px-3 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded-lg\",\"children\":\"Component Design\"}]]}],[\"$\",\"h1\",null,{\"className\":\"text-2xl md:text-4xl text-gray-900 dark:text-gray-100 mb-6 leading-tight\",\"children\":\"forwardRef\"}],[\"$\",\"p\",null,{\"className\":\"font-light text-md text-gray-600 dark:text-gray-400 leading-relaxed mb-6 italic\",\"children\":\"P -\u003e C -\u003e DOM的ref 传递器\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center text-sm text-gray-500 dark:text-gray-500\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2022-12-19\",\"children\":\"2022年12月19日\"}]}],[\"$\",\"div\",null,{\"className\":\"w-16 h-px bg-gray-300 dark:bg-gray-600 mt-8\"}]]}],[\"$\",\"article\",null,{\"className\":\"max-w-none prose prose-pink prose-img:rounded-lg prose-video:rounded-lg dark:prose-invert prose-a:text-foreground prose-a:decoration-6 prose-a:-underline-offset-2 prose-a:decoration-pink-300\",\"children\":\"$L13\"}],[\"$\",\"footer\",null,{\"className\":\"mt-16 pt-8 border-t border-gray-200 dark:border-gray-700\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex justify-between items-center\",\"children\":[[\"$\",\"$L14\",null,{\"href\":\"/blog\",\"className\":\"text-sm text-gray-600 dark:text-gray-400 hover:text-pink-900 dark:hover:text-pink-100 transition-colors\",\"children\":\"← 返回博客列表\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-sm text-gray-500 dark:text-gray-500\",\"children\":\"标签:\"}],[\"$\",\"div\",null,{\"className\":\"flex gap-1\",\"children\":[[\"$\",\"span\",\"React\",{\"className\":\"text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded\",\"children\":\"React\"}],[\"$\",\"span\",\"forwardRef\",{\"className\":\"text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded\",\"children\":\"forwardRef\"}],[\"$\",\"span\",\"Hooks\",{\"className\":\"text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded\",\"children\":\"Hooks\"}],[\"$\",\"span\",\"Component Design\",{\"className\":\"text-xs px-2 py-1 bg-pink-100 dark:bg-pink-800 text-pink-600 dark:text-pink-400 rounded\",\"children\":\"Component Design\"}]]}]]}]]}]}]]}]}]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"11:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"forwardRef | 格物致知\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"P -\u003e C -\u003e DOM的ref 传递器\"}],[\"$\",\"meta\",\"2\",{\"name\":\"keywords\",\"content\":\"React forwardRef,React Hooks,useImperativeHandle,ref forwarding,组件设计,React 进阶,前端架构,组件封装,TypeScript React\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:title\",\"content\":\"forwardRef\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:description\",\"content\":\"P -\u003e C -\u003e DOM的ref 传递器\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:image\",\"content\":\"http://localhost:3000/forward-ref.png\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image:alt\",\"content\":\"forwardRef\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"8\",{\"property\":\"article:published_time\",\"content\":\"2022-12-19\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:title\",\"content\":\"forwardRef\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:description\",\"content\":\"P -\u003e C -\u003e DOM的ref 传递器\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:image\",\"content\":\"http://localhost:3000/forward-ref.png\"}]],\"error\":null,\"digest\":\"$undefined\"}\nb:{\"metadata\":\"$11:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:[[\"$\",\"p\",null,{\"children\":\"前两天，我在开发一个表单组件库时遇到了一个看似简单的需求：产品经理希望能够在点击submit button后聚焦到第一个验证出错的输入框。听起来很简单，对吧？\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 最初的想法\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" MyForm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" handleFocus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    inputRef.current.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 简单粗暴\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"CustomInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" onClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"handleFocus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e聚焦输入框\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"但是当我实际运行代码时，却得到了一个让我困惑的错误：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Warning: Function components cannot be given refs.\\nAttempts to access this ref will fail.\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"啥玩意?\"}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"问题的根源：Ref 传递的困境\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"Parent Component\"}],[\"$\",\"mover\",null,{\"children\":[[\"$\",\"mo\",null,{\"stretchy\":\"true\",\"minsize\":\"3.0em\",\"children\":\"→\"}],[\"$\",\"mpadded\",null,{\"width\":\"+0.6em\",\"lspace\":\"0.3em\",\"children\":[\"$\",\"mtext\",null,{\"children\":\"ref\"}]}]]}],[\"$\",\"mtext\",null,{\"children\":\"Child Component\"}],[\"$\",\"mover\",null,{\"children\":[[\"$\",\"mo\",null,{\"stretchy\":\"true\",\"minsize\":\"3.0em\",\"children\":\"→\"}],[\"$\",\"mpadded\",null,{\"width\":\"+0.6em\",\"lspace\":\"0.3em\",\"children\":[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"?\"}]}]]}],[\"$\",\"mtext\",null,{\"children\":\"DOM Element\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\text{Parent Component} \\\\xrightarrow{\\\\text{ref}} \\\\text{Child Component} \\\\xrightarrow{?} \\\\text{DOM Element}\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1.3025em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"Parent Component\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel x-arrow\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"1.1081em\"},\"children\":[[\"$\",\"span\",null,{\"style\":{\"top\":\"-3.322em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight x-arrow-pad\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord text mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"ref\"}]}]}]}]]}],[\"$\",\"span\",null,{\"className\":\"svg-align\",\"style\":{\"top\":\"-2.689em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"hide-tail\",\"style\":{\"height\":\"0.522em\",\"minWidth\":\"1.469em\"},\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"400em\",\"height\":\"0.522em\",\"viewBox\":\"0 0 400000 522\",\"preserveAspectRatio\":\"xMaxYMin slice\",\"children\":[\"$\",\"path\",null,{\"d\":\"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z\"}]}]}]]}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.011em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1.3025em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"Child Component\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel x-arrow\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"1.1081em\"},\"children\":[[\"$\",\"span\",null,{\"style\":{\"top\":\"-3.322em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight x-arrow-pad\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mclose mtight\",\"children\":\"?\"}]}]}]]}],[\"$\",\"span\",null,{\"className\":\"svg-align\",\"style\":{\"top\":\"-2.689em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"hide-tail\",\"style\":{\"height\":\"0.522em\",\"minWidth\":\"1.469em\"},\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"400em\",\"height\":\"0.522em\",\"viewBox\":\"0 0 400000 522\",\"preserveAspectRatio\":\"xMaxYMin slice\",\"children\":[\"$\",\"path\",null,{\"d\":\"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z\"}]}]}]]}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.011em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"DOM Element\"}]}]]}]]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"在 React 中，ref 不会自动传递给函数组件的内部元素。这是因为：\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"函数组件没有实例\"}],\"：与类组件不同，函数组件没有实例可以被 ref 引用\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"ref 不是 prop\"}],\"：ref 是一个特殊的属性，不会出现在 props 中\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"封装性原则\"}],\"：React 希望组件的内部实现是封装的\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 这个组件接收不到 ref\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" CustomInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" }) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 父组件的 ref 传递失败\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" App\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"CustomInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// ❌ 不会工作\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"forwardRef 登场\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"forwardRef\"}],\" 就像是一个\\\"ref 传递器\\\"，它让我们能够将 ref 从父组件传递到子组件的内部 DOM 元素：\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 使用 forwardRef 包装组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" CustomInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"});\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 现在可以正常工作了\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" App\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" handleFocus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    inputRef.current?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// ✅ 成功！\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"CustomInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"请输入内容\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" onClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"handleFocus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e聚焦输入框\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"深入理解 forwardRef 的工作原理\"}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"1. 函数签名的变化\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 普通函数组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" Component\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props.children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// forwardRef 包装后的组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" Component\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props.children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"});\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"关键变化：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"第二个参数 \",[\"$\",\"code\",null,{\"children\":\"ref\"}],\" 被显式传入\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"可以将 \",[\"$\",\"code\",null,{\"children\":\"ref\"}],\" 传递给任何内部元素\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"组件的调用方式不变\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"2. TypeScript 中的类型定义\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 定义 props 类型\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"interface\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" CustomInputProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"  placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"?:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"  disabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"?:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 使用 forwardRef 的正确类型定义\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" CustomInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"HTMLInputElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"CustomInputProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  ({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"disabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" }, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"input\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"placeholder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        disabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"disabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"        {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  },\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"经典使用场景分析\"}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"1. 表单控件封装\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这是我在工作中最常遇到的场景：\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 封装一个带验证的输入框\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ValidatedInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  ({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"validation\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" }, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"isValid\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"setIsValid\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" handleBlur\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (validation) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"        const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" valid\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" validation\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(e.target.value);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"        setIsValid\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(valid);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      props.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"onBlur\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"?.(e);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"form-field\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"input\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"          ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"          {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"          onBlur\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"handleBlur\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"          className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"`input ${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"isValid\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" ?\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" :\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"\\\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"        {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"error \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"\u0026\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" !\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"isValid \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"\u0026\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"span\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"error-text\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"span\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  },\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 使用方式\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" LoginForm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" emailRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" passwordRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" handleSubmit\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"    // 可以直接访问原生 DOM 方法\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"emailRef.current.value) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      emailRef.current.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"    // 提交逻辑...\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" onSubmit\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"handleSubmit\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"ValidatedInput\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"emailRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        label\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"邮箱\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"email\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        validation\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" /\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"\\\\S\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"@\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"\\\\S\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\",\"fontWeight\":\"bold\"},\"children\":\"\\\\.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"\\\\S\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"test\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(value)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"请输入有效的邮箱地址\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"ValidatedInput\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"passwordRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        label\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"密码\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"password\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        validation\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" value.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"length\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" \u003e=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" 6\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"        error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"密码至少6位\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"submit\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e登录\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"2. 第三方库的集成\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"当我们需要集成第三方库时，forwardRef 特别有用：\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 封装一个基于第三方库的组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" RichTextEditor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  ({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"initialValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"onContentChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" }, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" editorRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"    // 使用 useImperativeHandle 暴露特定方法\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    useImperativeHandle\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(ref, () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"      focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" editorRef.current?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"      getContent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" editorRef.current?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"getContent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"      setContent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"content\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" editorRef.current?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"setContent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(content),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"      insertText\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" editorRef.current?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"insertText\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(text),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    }));\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"      // 初始化第三方编辑器\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" editor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" ThirdPartyEditor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(editorRef.current, {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        initialValue,\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        onChange: onContentChange,\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"        ...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      });\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" editor.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"destroy\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    }, []);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"editorRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"rich-editor\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  },\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"3. 动画库的集成\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 封装一个带动画的组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" AnimatedCard\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  ({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"animationType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"fade\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" }, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" cardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"    // 组合 refs\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" combinedRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useMemo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" cardRef;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        cardRef.current \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" node;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"        if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"typeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ref \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"          ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(node);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"          ref.current \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" node;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    }, [ref]);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"      // 使用动画库\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" animation\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" gsap.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(cardRef.current, {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        opacity: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        y: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"20\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        duration: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"0.3\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      });\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" animation.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"kill\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    }, []);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"combinedRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"animated-card\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"        {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  },\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"forwardRef 的适用范围\"}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"✅ 适用场景\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"UI 组件库开发\"}],\"：需要暴露底层 DOM 元素的方法\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"表单控件封装\"}],\"：需要访问原生表单元素\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"第三方库集成\"}],\"：需要将 ref 传递给第三方组件\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"动画控制\"}],\"：需要直接操作 DOM 进行动画\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"焦点管理\"}],\"：需要程序化控制焦点\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"❌ 不适用场景\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"简单的数据展示组件\"}],\"：不需要 DOM 操作\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"纯函数式组件\"}],\"：没有副作用的组件\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"高频重渲染组件\"}],\"：forwardRef 会增加少量性能开销\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"内部状态管理\"}],\"：应该使用 props 和 state\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"相关概念深度解析\"}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"1. useImperativeHandle：精确控制暴露接口\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" CustomInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"setValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"  // 只暴露特定的方法，而不是整个 DOM 元素\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  useImperativeHandle\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(ref, () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" inputRef.current?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    clear\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"      setValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      inputRef.current?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    },\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    getValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" value,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"    setValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"newValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" setValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(newValue),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"    // 不暴露原生 DOM 元素的其他方法\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }));\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"input\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"inputRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      onChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" setValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(e.target.value)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"});\"}]}]]}]}]}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"2. Ref 的多种类型\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 1. useRef 创建的 ref\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" myRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 2. createRef 创建的 ref（类组件中）\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" myRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" createRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 3. 回调 ref\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" myRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useCallback\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (node) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"    // DOM 元素挂载时的逻辑\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    node.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"focus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}, []);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 4. 字符串 ref（已废弃，不推荐）\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// \u003cdiv ref=\\\"myRef\\\" /\u003e\"}]}]]}]}]}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"3. Ref 的组合和传递\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 高阶组件中的 ref 传递\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" withLogging\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"WrappedComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" WithLoggingComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" logProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Props:\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", props);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"WrappedComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" onFocus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"logProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  });\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  WithLoggingComponent.displayName \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" `withLogging(${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"WrappedComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"displayName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" ||\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" WrappedComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"})`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" WithLoggingComponent;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"实际项目中的最佳实践\"}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"1. 组件库的设计模式\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 基础组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" BaseInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" }, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"`base-input ${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" ||\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"\\\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"});\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 扩展组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" SearchInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"onSearch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" }, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"searchTerm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"setSearchTerm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" handleKeyPress\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (e.key \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"Enter\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"      onSearch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"?.(searchTerm);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"BaseInput\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"searchTerm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      onChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" setSearchTerm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(e.target.value)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"      onKeyPress\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"handleKeyPress\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  );\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"});\"}]}]]}]}]}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"2. 错误处理和边界情况\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" SafeForwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" localRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"  // 安全的 ref 处理\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" safeRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useMemo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" localRef;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      localRef.current \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" node;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"        if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"typeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ref \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"          ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(node);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (ref \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"\u0026\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" typeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ref \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"object\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"          ref.current \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" node;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"catch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (error) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Ref assignment failed:\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", error);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }, [ref]);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"safeRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"});\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"性能考虑\"}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"forwardRef 的性能影响\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// forwardRef 本身的性能开销很小\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" MemoizedComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" memo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  forwardRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"    // 组件逻辑\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" {...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }),\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// 但要注意避免不必要的重新创建\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" ParentComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"  // ❌ 每次渲染都会创建新的 ref\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" createRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"  // ✅ 正确的做法\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" stableRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8DDB8C\"},\"children\":\"MemoizedComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"stableRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"};\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"总结\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"forwardRef 使用原则：\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"最小暴露原则\"}],\"：只暴露必要的接口，使用 \",[\"$\",\"code\",null,{\"children\":\"useImperativeHandle\"}],\" 精确控制\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"类型安全\"}],\"：在 TypeScript 中明确定义 ref 类型\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"向后兼容\"}],\"：设计 API 时考虑未来的扩展性\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"错误处理\"}],\"：优雅地处理 ref 传递中的异常情况\"]}],\"\\n\"]}]]\n"])</script></body></html>